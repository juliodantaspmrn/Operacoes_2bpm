<!DOCTYPE html>
<html lang="pt-BR">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2¬∫ BPM ‚Äì Efetivo Extra Carnaval 2026</title>

<style>
body{
    font-family: Arial, Helvetica, sans-serif;
    background:#f4f6f8;
    margin:0;
    color:#1f2937;
}

/* HEADER */
header{
    background:#0f172a;
    color:#fff;
    padding:20px;
    text-align:center;
}
.brasao{
    width:110px;
    margin-bottom:10px;
    display:block;
    margin:auto;
}
header h1{
    margin:0;
    font-size:22px;
}
header p{
    margin-top:5px;
    font-size:14px;
    opacity:.9;
}

/* CONTAINER */
.container{
    max-width:1200px;
    margin:auto;
    padding:20px;
}

/* BUSCA */
.controls{
    display:flex;
    margin-bottom:15px;
}
.search{
    flex:1;
    position:relative;
}
.search input{
    width:100%;
    padding:10px 38px 10px 10px;
    font-size:15px;
    border-radius:6px;
    border:1px solid #cbd5e1;
}
.search span{
    position:absolute;
    right:12px;
    top:50%;
    transform:translateY(-50%);
    font-size:18px;
    color:#64748b;
}

/* FILTROS */
.filtros-dia{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    margin-bottom:20px;
}
.filtros-dia button{
    padding:6px 12px;
    border:1px solid #0f172a;
    background:#fff;
    color:#0f172a;
    border-radius:5px;
    cursor:pointer;
    font-size:13px;
}
.filtros-dia button.ativo,
.filtros-dia button:hover{
    background:#0f172a;
    color:#fff;
}

/* BLOCOS */
.day{
    background:#fff;
    border-radius:8px;
    padding:15px;
    margin-bottom:30px;
    box-shadow:0 2px 5px rgba(0,0,0,.05);
}
.day h2{
    margin:0 0 10px;
    border-bottom:2px solid #0f172a;
    padding-bottom:5px;
}
.city{
    margin-top:15px;
}
.city h3{
    margin-bottom:8px;
    color:#0f172a;
}

/* TABELA */
table{
    width:100%;
    border-collapse:collapse;
    font-size:14px;
}
th, td{
    border:1px solid #e5e7eb;
    padding:7px;
    text-align:left;
}
th{
    background:#f1f5f9;
}

/* FOOTER */
footer{
    text-align:center;
    font-size:12px;
    color:#64748b;
    margin:30px 0 10px;
}

/* MOBILE ‚Äì IGUAL AO ORIGINAL */
@media (max-width:768px){

    table{
        width:100%;
        table-layout:fixed;   /* ESSENCIAL */
        font-size:11px;
    }

    th, td{
        padding:4px 3px;
        word-break:break-word;
        overflow-wrap:break-word;
        white-space:normal;
        hyphens:auto;
    }

    /* Ordem */
    th:nth-child(1),
    td:nth-child(1){
        width:32px;
        text-align:center;
    }

    /* Gradua√ß√£o */
    th:nth-child(2),
    td:nth-child(2){
        width:58px;
        text-align:center;
        font-size:10px;
    }

    /* Nome (flex√≠vel, mas controlado) */
    th:nth-child(3),
    td:nth-child(3){
        width:auto;
    }

    /* Matr√≠cula */
    th:nth-child(4),
    td:nth-child(4){
        width:70px;
        text-align:center;
        font-size:10px;
        white-space:nowrap;
    }

    /* OPM */
    th:nth-child(5),
    td:nth-child(5){
        width:52px;
        text-align:center;
        font-size:10px;
    }

    /* Tipo de policiamento */
    th:nth-child(6),
    td:nth-child(6){
        width:62px;
        text-align:center;
        font-size:10px;
        white-space:normal;
    }
}


/* LOGIN */
#login{
    position:fixed;
    inset:0;
    background:#0f172a;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:9999;
}
#loginBox{
    background:#fff;
    padding:22px;
    width:320px;
    border-radius:10px;
}
#loginBox h2{
    margin:0 0 5px;
    font-size:18px;
    text-align:center;
}
#loginBox p{
    font-size:12px;
    color:#475569;
    text-align:center;
}
#loginBox input{
    width:100%;
    padding:9px;
    margin:8px 0;
    border:1px solid #cbd5e1;
    border-radius:5px;
}
#loginBox button{
    width:100%;
    padding:10px;
    background:#0f172a;
    color:#fff;
    border:none;
    border-radius:5px;
    cursor:pointer;
}
#erro{
    color:red;
    display:none;
    text-align:center;
    margin-top:8px;
    font-size:13px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
    <div id="loginBox">
        <img src="brasao_pmrn.png" alt="Bras√£o PMRN"
     style="width:90px;display:block;margin:0 auto 10px;">

        <h2>Opera√ß√£o Carnaval ‚Äì 2¬∫ BPM</h2>
        <p><strong>Valida√ß√£o de Acesso Funcional</strong></p>

        <input id="loginNome" placeholder="Primeiro nome">
        <input id="loginMat" placeholder="Matr√≠cula completa">

        <button onclick="validar()">Acessar</button>

        <p id="erro">Dados n√£o localizados na escala.</p>

        <p style="margin-top:10px;font-size:11px;">
            Consulta interna de efetivo, restrita ao servi√ßo policial.
            Dados tratados conforme a Lei n¬∫ 13.709/2018 (LGPD).
        </p>
    </div>
</div>

<header>
    <img src="brasao_pmrn.png" alt="Bras√£o 2¬∫ BPM" class="brasao">
    <h1>2¬∫ BPM ‚Äì Efetivo Extra Refor√ßo Carnaval 2026</h1>
    <p>Mossor√≥ ‚Ä¢ Tibau ‚Ä¢ Grossos ‚Ä¢ Gov. Dix-Sept Rosado</p>
</header>

<div class="container">

    <div class="controls">
        <div class="search">
            <input type="text" id="searchInput" placeholder="Buscar por nome ou matr√≠cula">
            <span>üîç</span>
        </div>
    </div>

    <div class="filtros-dia">
        <button class="ativo" onclick="filtrarDia('',this)">Todos</button>
        <button onclick="filtrarDia('13',this)">Dia 13</button>
        <button onclick="filtrarDia('14',this)">Dia 14</button>
        <button onclick="filtrarDia('15',this)">Dia 15</button>
        <button onclick="filtrarDia('16',this)">Dia 16</button>
        <button onclick="filtrarDia('17',this)">Dia 17</button>
        <button onclick="filtrarDia('18',this)">Dia 18</button>
    </div>

    <div id="conteudo"></div>
</div>

<footer>
    PMRN ‚Ä¢ 2¬∫ BPM ‚Ä¢ Opera√ß√£o Carnaval 2026
</footer>

<script>
let dados=[];
let diaSelecionado='';

function formatarNome(nome){
    if(!nome) return '';

    const partes = nome
        .replace(/\u00A0/g,' ')
        .trim()
        .split(/\s+/)
        .map(p =>
            p.charAt(0).toUpperCase() +
            p.slice(1).toLowerCase()
        );

    if(partes.length === 1) return partes[0];

    const primeiro = partes[0];
    const segundoInicial = partes[1].charAt(0).toUpperCase() + '.';
    const resto = partes.slice(2).join(' ');

    return [primeiro, segundoInicial, resto].filter(Boolean).join(' ');
}


function normalizar(t){
    return (t||'')
    .replace(/\u00A0/g,' ')
    .normalize('NFD')
    .replace(/[\u0300-\u036f]/g,'')
    .toUpperCase()
    .trim();
}

fetch('./efetivo2.csv')
.then(r=>r.text())
.then(text=>{
    const linhas=text.replace(/^\uFEFF/,'').split(/\r?\n/).filter(l=>l.trim());
    linhas.shift();
    dados=linhas.map(l=>{
        const c=l.split(';');
        return{
            DIA:c[0],ORDEM:c[1],GRAD:c[2],NOME:c[3],
            MAT:c[4],OPM:c[5],TIPO:c[6],LOCAL:c[7]
        };
    });
    render();
});

function validar(){
    const nome=normalizar(loginNome.value).split(' ')[0];
    const mat=loginMat.value.replace(/\D/g,'');
    const ok=dados.some(d=>{
        return normalizar(d.NOME).split(' ')[0]===nome &&
               d.MAT.replace(/\D/g,'')===mat;
    });
    if(ok) login.remove();
    else erro.style.display='block';
}

searchInput.addEventListener('input',render);

function filtrarDia(v,b){
    diaSelecionado=v;
    document.querySelectorAll('.filtros-dia button').forEach(x=>x.classList.remove('ativo'));
    b.classList.add('ativo');
    render();
}

function mascara(m){
    const c=m.replace(/\D/g,'');
    return c.substring(0,3)+'***'+c.substring(6);
}

function render(){
    const f=searchInput.value.toLowerCase();
    conteudo.innerHTML='';
    const fil=dados.filter(d=>{
        return (!diaSelecionado||d.DIA.includes(diaSelecionado)) &&
        (d.NOME.toLowerCase().includes(f)||d.MAT.includes(f));
    });
    const mapa={};
    fil.forEach(d=>{
        mapa[d.DIA]=mapa[d.DIA]||{};
        mapa[d.DIA][d.LOCAL]=mapa[d.DIA][d.LOCAL]||[];
        mapa[d.DIA][d.LOCAL].push(d);
    });
    for(const dia in mapa){
        let h=`<div class="day"><h2>üìÖ Dia ${dia}</h2>`;
        for(const loc in mapa[dia]){
            h+=`<div class="city"><h3>üìç ${loc}</h3><table>
            <tr><th>Ord.</th><th>Grad.</th><th>Nome</th><th>Mat.</th><th>OPM</th><th>Tipo</th></tr>`;
            mapa[dia][loc].forEach(p=>{
                h+=`<tr>
                <td>${p.ORDEM}</td><td>${p.GRAD}</td><td>${formatarNome(p.NOME)}</td>


                <td>${mascara(p.MAT)}</td><td>${p.OPM}</td><td>${p.TIPO}</td>
                </tr>`;
            });
            h+=`</table></div>`;
        }
        h+=`</div>`;
        conteudo.innerHTML+=h;
    }
}
</script>

</body>
</html>
